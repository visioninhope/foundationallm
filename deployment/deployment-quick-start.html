<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
      <title>Deployment - Quick Start | FoundationaLLM </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Deployment - Quick Start | FoundationaLLM ">
      
      
      <link rel="icon" href="../media/favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/solliancenet/foundationallm/blob/main/docs/deployment/deployment-quick-start.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../media/fllm-icon.svg" alt="FoundationaLLM">
            FoundationaLLM
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">

      <div class="content">
        <div class="actionbar">

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="deployment---quick-start">Deployment - Quick Start</h1>

<p>Foundationa<strong>LLM</strong> is designed for seamless deployment within your Azure Subscription. It initially utilizes Azure Container Apps (ACA) for rapid deployment and streamlined development. For scaling up to production environments, FoundationaLLM also supports deployment on Azure Kubernetes Service (AKS), offering robust scalability and management features.</p>
<p>Be mindful of the <a href="https://learn.microsoft.com/azure/ai-services/openai/quotas-limits">Azure OpenAI regional quota limits</a> on the number of Azure OpenAI Service instances. To optimize resource usage, FoundationaLLM offers the flexibility to connect to an existing Azure OpenAI Service resource, thereby avoiding the creation of additional instances during deployment. This feature is particularly useful for managing resource allocation and ensuring efficient Azure OpenAI Service quota utilization.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>You will need the following resources and access to deploy the solution:</p>
<ul>
<li><strong>Azure Subscription</strong>: An Azure Subscription is a logical container in Microsoft Azure that links to an Azure account and is the basis for billing, resource management, and allocation. It allows users to create and manage Azure resources like virtual machines, databases, and more, providing a way to organize access and costs associated with these resources.</li>
<li><strong>Subscription access to Azure OpenAI service</strong>: Access to Azure OpenAI Service provides users with the ability to integrate OpenAI's advanced AI models and capabilities within Azure. This service combines OpenAI's powerful models with Azure's robust cloud infrastructure and security, offering scalable AI solutions for a variety of applications like natural language processing and generative tasks. <strong>Start here to <a href="https://customervoice.microsoft.com/Pages/ResponsePage.aspx?id=v4j5cvGGr0GRqy180BHbR7en2Ais5pxKtso_Pz4b1_xUNTZBNzRKNlVQSFhZMU9aV09EVzYxWFdORCQlQCN0PWcu">Request Access to Azure OpenAI Service</a></strong></li>
<li><strong>Minimum quota of 65 CPUs across all VM family types</strong>: Azure CPU quotas refer to the limits set on the number and type of virtual CPUs that can be used in an Azure Subscription. These quotas are in place to manage resource allocation and ensure fair usage across different users and services. Users can request quota increases if their application or workload requires more CPU resources. <strong>Start here to <a href="https://learn.microsoft.com/azure/quotas/per-vm-quota-requests">Manage VM Quotas</a></strong></li>
<li><strong>App Registrations created in the Entra ID tenant (formerly Azure Active Directory)</strong>: Azure App Registrations is a feature in Entra ID that allows developers to register their applications for identity and access management. This registration process enables applications to authenticate users, request and receive tokens, and access Azure resources that are secured by Entra ID. <strong>Follow the instructions in the <a href="authentication-authorization/index.html">Authentication and Authorization setup document</a> to configure authentication for the solution.</strong></li>
<li><strong>User with the proper role assignments</strong>: Azure Role-Based Access Control (RBAC) roles are a set of permissions in Azure that control access to Azure resource management. These roles can be assigned to users, groups, and services in Azure, allowing granular control over who can perform what actions within a specific scope, such as a subscription, resource group, or individual resource.
<ul>
<li>Owner on the target subscription</li>
<li>Owner on the App Registrations described in the Authentication setup document</li>
</ul>
</li>
</ul>
<p>You will use the following tools during deployment:</p>
<ul>
<li><strong>Azure Developer CLI (<a href="https://learn.microsoft.com/azure/developer/azure-developer-cli/install-azd">v1.6.1 or greater</a>)</strong></li>
<li><strong>Azure CLI (<a href="https://docs.microsoft.com/cli/azure/install-azure-cli">v2.51.0 or greater</a>):</strong></li>
<li><strong>Latest <a href="https://git-scm.com/downloads">Git</a></strong></li>
<li><strong>PowerShell 7 (<a href="https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-windows?view=powershell-7.4">7.4.1 or greater</a>)</strong></li>
</ul>
<p><strong>Optional</strong> To run or debug the solution locally, you will need to install the following dependencies:</p>
<ul>
<li><strong><a href="https://dotnet.microsoft.com/download/dotnet/8.0">.NET 8 SDK</a></strong></li>
<li><strong>Visual Studio 2022</strong></li>
</ul>
<p><strong>Optional</strong> To build or test container images, you will need to install the following dependencies:</p>
<ul>
<li><strong><a href="https://www.docker.com/products/docker-desktop/">Docker Desktop</a></strong></li>
</ul>
<div class="IMPORTANT">
<h5>Important</h5>
<p>The perception of the <code>main</code> branch in GitHub, or any version control system, can vary depending on the development workflow adopted by a particular team or organization. The Foundationa<strong>LLM</strong> team uses the <code>main</code> branch as the primary <strong>development</strong> branch. In this case, the <code>main</code> branch might indeed be considered a <strong>work in progress</strong>, with developers regularly pushing changes and updates directly to it. It is where ongoing development work happens.
So for deployment purposes, it is recommended to use the latest release branch, which is considered stable and tested. The release branch is a snapshot of the <code>main</code> branch at a specific point in time, where the code is considered stable and ready for deployment. The release branch is tagged with a version number, such as <code>0.6.0</code>, and is the recommended branch for deployment.  Please find our latest releases <a href="https://github.com/solliancenet/foundationallm/releases">here</a></p>
</div>
<h2 id="deployment-steps">Deployment steps</h2>
<p>Follow the steps below to deploy the solution to your Azure subscription.
If you are upgrading from a previous version, like <code>0.5.0</code>, please refer to the changes in the <a href="../release-notes/breaking-changes.html">breaking changes notes</a>.</p>
<div class="IMPORTANT">
<h5>Important</h5>
<p>Follow the instructions in the <a href="authentication-authorization/index.html">Authentication and Authorization setup document</a> to finalize authentication and authorization for the solution. Bear in mind that creating the app registrations in the Entra ID tenant is a <strong>prerequisite</strong> for the deployment, but you will have to revisit some of these settings after the deployment is complete later to fill in some missing values that are generated during the deployment.</p>
</div>
<ol>
<li><p>Ensure all the prerequisites are met and you have installed the tools required to complete the deployment.</p>
</li>
<li><p>From a PowerShell prompt, execute the following to clone the repository:</p>
<pre><code class="lang-cmd">git clone https://github.com/solliancenet/foundationallm.git
cd foundationallm/deploy/quick-start
git checkout release/0.7.0
</code></pre>
</li>
<li><p><strong>For release 0.7.0+:</strong> Run the following script to install the deployment utilities, including <code>AzCopy</code>, locally.</p>
<pre><code class="lang-cmd">./scripts/bootstrap.ps1
</code></pre>
</li>
<li><p>Run the following commands to log into Azure CLI, Azure Developer CLI and AzCopy:</p>
<pre><code class="lang-azurecli">az login            # Log into Azure CLI
azd auth login      # Log into Azure Developer CLI
azcopy login        # Log into AzCopy
</code></pre>
</li>
<li><p>Set up an <code>azd</code> environment targeting your Azure subscription and desired deployment region:</p>
<pre><code class="lang-azurecli"># Set your target Subscription and Location
azd env new --location &lt;Supported Azure Region&gt; --subscription &lt;Azure Subscription ID&gt;
</code></pre>
</li>
<li><p>Run the following commands to set the appropriate application registration settings for OIDC authentication.</p>
<pre><code class="lang-text">azd env set ENTRA_AUTH_API_INSTANCE &lt;Auth API Instance&gt;
azd env set ENTRA_AUTH_API_CLIENT_ID &lt;Auth API Client Id&gt;
azd env set ENTRA_AUTH_API_SCOPES &lt;Auth API Scope&gt;
azd env set ENTRA_AUTH_API_TENANT_ID &lt;Auth API Tenant ID&gt;

azd env set ADMIN_GROUP_OBJECT_ID &lt;Admin Group Object Id&gt;

azd env set ENTRA_CHAT_UI_CLIENT_ID &lt;Chat UI Client Id&gt;
azd env set ENTRA_CHAT_UI_SCOPES &lt;Chat UI Scope&gt;
azd env set ENTRA_CHAT_UI_TENANT_ID &lt;Chat UI Tenant ID&gt;

azd env set ENTRA_CORE_API_CLIENT_ID &lt;Core API Client Id&gt;
azd env set ENTRA_CORE_API_SCOPES &lt;Core API Scope&gt;
azd env set ENTRA_CORE_API_TENANT_ID &lt;Core API Tenant ID&gt;

azd env set ENTRA_MANAGEMENT_API_CLIENT_ID &lt;Management API Client Id&gt;
azd env set ENTRA_MANAGEMENT_API_SCOPES &lt;Management API Scope&gt;
azd env set ENTRA_MANAGEMENT_API_TENANT_ID &lt;Management API Tenant ID&gt;

azd env set ENTRA_MANAGEMENT_UI_CLIENT_ID &lt;Management UI Client Id&gt;
azd env set ENTRA_MANAGEMENT_UI_SCOPES &lt;Management UI Scope&gt;
azd env set ENTRA_MANAGEMENT_UI_TENANT_ID &lt;Management UI Tenant ID&gt;

azd env set FOUNDATIONALLM_INSTANCE_ID &lt;guid&gt;
</code></pre>
</li>
</ol>
<div class="NOTE">
<h5>Note</h5>
<p>You need to manually generate a GUID for <code>FOUNDATIONALLM_INSTANCE_ID</code>.</p>
</div>
<h3 id="in-bash">In Bash:</h3>
<pre><code class="lang-bash">  uuidgen
</code></pre>
<h3 id="in-powershell">In PowerShell:</h3>
<pre><code class="lang-powershell">  [guid]::NewGuid().ToString()
</code></pre>
<div class="IMPORTANT">
<h5>Important</h5>
<p>The ADMIN_GROUP_OBJECT_ID in the Entra ID Groups has to be of type <code>security</code> NOT <code>Microsoft 365</code> and you need to at least add yourself to the group and other members that need to be admins.</p>
</div>
<ol>
<li><p><strong>Optional</strong>: Bring Your Own Azure OpenAI Instance</p>
<p>If you have an existing Azure OpenAI instance, you can use it by setting the following environment variables:</p>
<pre><code class="lang-text">azd env set OPENAI_NAME &lt;OpenAI Name&gt;
azd env set OPENAI_RESOURCE_GROUP &lt;OpenAI Resource Group&gt;
azd env set OPENAI_SUBSCRIPTION_ID &lt;OpenAI Subscription ID&gt;
</code></pre>
</li>
</ol>
<div class="IMPORTANT">
<h5>Important</h5>
<p>Deploying with <code>Bring Your Own Azure OpenAI</code>, customers need to make sure that the relevant Managed Identities (LangChain API, Semantic Kernel API, and Gateway API) are assigned the <code>Open AI reader role</code> on the Azure OpenAI account object.</p>
</div>
<ol start="2">
<li><p>Deploy the solution</p>
<p>After setting the OIDC-specific settings in the AZD environment above, run <code>azd up</code> in the same folder location to provision the infrastructure, update the App Configuration entries, deploy the API and web app services, and import files into the storage account.</p>
<pre><code class="lang-pwsh">azd up
</code></pre>
</li>
</ol>
<h3 id="running-script-to-allow-ms-graph-access-through-role-permissions">Running script to allow MS Graph access through Role Permissions</h3>
<p>After the deployment is complete, you will need to run the following script to allow MS Graph access through Role Permissions. <a href="https://github.com/solliancenet/foundationallm/blob/main/deploy/common/scripts/Assign-MSGraph-Roles.ps1">Role Permissions Script</a>
This script will need to be executed twice for the principal IDs of the following:</p>
<ul>
<li>Core API Managed Identity</li>
<li>Management API Managed Identity</li>
</ul>
<p>These can be found in the Azure portal in the main resource group for the deployment.</p>
<div class="TIP">
<h5>Tip</h5>
<p>The user running the script will need to have the appropriate permissions to assign roles to the managed identities. The user will need to be a <code>Global Administrator</code> or have the <code>Privileged Role Administrator</code> role in the Entra ID tenant.</p>
</div>
<p>The syntax for running the script from the <code>deploy\common\scripts</code> folder is:</p>
<pre><code class="lang-pwsh">.\Assign-MSGraph-Roles.ps1 -principalId &lt;GUID of the Core API Managed Identity Principal ID&gt;
.\Assign-MSGraph-Roles.ps1 -principalId &lt;GUID of the Management API Managed Identity Principal ID&gt;
</code></pre>
<div class="IMPORTANT">
<h5>Important</h5>
<p>For this release, you will need to restart the <code>CORE API</code> container and the <code>MANAGEMENT API</code> container in the resource group to allow the changes to take effect.</p>
</div>
<h1 id="teardown">Teardown</h1>
<p>To tear down the environment, execute <code>azd down</code> in the same folder location.</p>
<pre><code class="lang-pwsh">azd down --purge
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>The <code>--purge</code> argument in the command above. This ensures that resources that would otherwise be soft-deleted are instead completely purged from your Azure subscription.</p>
</div>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/solliancenet/foundationallm/blob/main/docs/deployment/deployment-quick-start.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          © FoundationaLLM. All rights reserved. | Find out more about FoundationaLLM at <a href="https://foundationallm.ai">foundationallm.ai</a>.
        </div>
      </div>
    </footer>
  </body>
</html>
